@using Core
<!-- Adgang til IsearchLogic-->
@page "/search"  
@inject ISearchLogic SearchLogic
<!-- Til udførelse af søgninger-->

<h3>Search</h3>
<InputText @bind-Value="searchQuery" placeholder="Enter search query" />
<button @onclick="PerformSearch">Search</button>

@if (searchResult != null)
{
    <div>
        <h4>Results:</h4>
        @if (searchResult.Result?.DocumentHits != null)
        {
            @foreach (var result in searchResult.Result.DocumentHits)
            {
                <p>@result.Document?.Title - @result.Document?.Snippet</p>
            }
        }
        <h4>Snippets:</h4>
        @if (searchResult.Snippets != null && searchResult.Snippets.Any())
        {
            @foreach (var snippet in searchResult.Snippets)
            {
                <p>@snippet</p>
            }
        }
        else
        {
            <p>@searchResult.ErrorMessage</p>
        }
    </div>
}
<!-- Logikken til at udføre søgningen-->
@code {
    private string searchQuery;
    private SearchResultWithSnippet searchResult;

    private async Task PerformSearch()
    {
        searchResult = await SearchLogic.SearchAsync(searchQuery.Split(' '), 10);
        if (searchResult.Snippets == null || !searchResult.Snippets.Any())
        {
            searchResult.ErrorMessage = "Fejl: Intet søgeord";
        }
    }
}
